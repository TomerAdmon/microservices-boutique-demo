spec_version: 2
description: 'ArgoCD | Create Nginx App'

inputs:
  agent:
    default: dev-playground-eks
    type: agent

grains:
  create-argo-app:
    kind: kubernetes
    spec:
      sources:
      - store: cloud-native-application
        path: argocd/apps/argo-nginx.yaml
      target-namespace: 'argocd'  
      agent:
        name: '{{ .inputs.agent }}'
        
  view-workloads:
    depends-on: create-argo-app
    kind: argocd
    spec:
      agent:
        name: '{{ .inputs.agent }}'
      mode: data
      project: '{{.inputs.project}}'
      application: 'nginx-app' # should be passed as a param

  
